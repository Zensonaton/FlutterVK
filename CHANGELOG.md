<!-- markdownlint-disable MD033 -->

# Flutter VK vTODO

**Важное предупреждение**: это **бета-обновление**, содержащее в себе немало технических изменений. Сейчас приложение находится в частично "поломанном" состоянии. Обновляйтесь только в том случае, если и вправду понимаете, что делаете. Вам, вероятнее всего, придётся откатиться до [предыдущей версии Flutter VK](https://github.com/Zensonaton/FlutterVK/releases) если Вы хотите стабильной работы приложения. **Сейчас очень много всего в приложении поломано**, и я это знаю. К примеру, такие вещи, как открытие плейлистов, кэширование, получение текстов песен и прочего целиком и полностью поломано.

Это обновление привносит в себя огромное техническое изменение: Переход от одной библиотеки для state-менеджмента, [`provider`](https://pub.dev/packages/provider) к другой, [`riverpod`](https://pub.dev/packages/riverpod)+[`flutter_hooks`](https://pub.dev/packages/flutter_hooks). Помимо этого, тут используется [`go_router`](https://pub.dev/packages/go_router) для навигации.

К сожалению, эти технические изменения почти что не видны обычному пользователю, однако они были нужны ради стабильной работы приложения, а так же различных оптимизаций.

## Изменения

- Немного изменил текст для `WelcomeRoute`.

<!-- Изменения с других Pre-release версий, которые должны быть отображены в non-pre версии:

## Изменения

- Новая настройка: "Тип палитры цветов обложки".
- Новое сообщение для README-файла, располагаемый в папке с кэшированными треками.
- Более правильный цвет у "свечения" обложек треков в мини и полноэкранном плееров.
- Своя реализация для получения цветов обложки трека, использующая Isolate где это возможно.
- Избавление от `WelcomeDialog` при авторизации.
- Избавление от `PhotoMaxOrig` ввиду ненадобности.
- Изменение текста для диалога "подключение рекомендаций".
- Избавление от диалога, спрашивающего разрешение на отправку статистики о прослушивании треков.
- Игнорирование ошибки "какой сейчас вайб не был найден".
- Управление плеером теперь использует toggle'ы вместо `!state`.
- Уменьшение количества вызовов `setState` от плеера.
- Удаление настройки "Точный алгоритм цветов плеера".
- Проверка на соответствие ID пользователей ВК при вторичной авторизации.

## Фиксы

- Фикс цветов приложения.
- Фикс OLED-темы.
- Фикс иконки настройки "канал обновлений".
- Фикс появления кнопки "В реальном времени" если не подключены рекомендации ВК.
- Фикс выхода из аккаунта, если нету папки с треками.
- Фикс появления плейлистов из раздела "в реальном времени" в виде Skeleton-loader'ов. -->
